<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Docker - PostMaster</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../extra.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Docker";
    var mkdocs_page_input_path = "Installation\Docker.md";
    var mkdocs_page_url = "/Installation/Docker/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> PostMaster</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>API</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/API%20Usage/">API Usage</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Configuration</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Configuration/Command%20Line%20Configuration/">Command Line Configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Configuration/Configurations%20Page/">Configurations Page</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Installation</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Docker</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#overview">Overview</a></li>
                
            
                <li class="toctree-l3"><a href="#prerequisites">Prerequisites</a></li>
                
            
                <li class="toctree-l3"><a href="#mysql-preparation">MySQL Preparation</a></li>
                
            
                <li class="toctree-l3"><a href="#installation">Installation</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Ubuntu%2014.04/">Ubuntu 14.04</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Windows%20Server%202012%20R2/">Windows Server 2012 R2</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">PostMaster</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Installation &raquo;</li>
        
      
    
    <li>Docker</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/stackfocus/postmaster" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h3 id="overview">Overview</h3>
<p>PostMaster is a Docker friendly application, however, it does require a data volume.
This is because PostMaster uses database migrations to safely upgrade the database schema.
The data volume contains auto-generated database migration scripts that allow you to revert back if a database migration ever failed.
If this folder is missing, PostMaster can't tell what state your database is in, and therefore, cannot revert back.
In this documentation, the data volume will be hosted in /opt/postmaster_data on the Docker host, but you can alter this in anyway you see fit.</p>
<h3 id="prerequisites">Prerequisites</h3>
<ol>
<li>An Ubuntu 14.04 mail server configured with the guide from <a href="https://www.digitalocean.com/community/tutorials/how-to-configure-a-mail-server-using-postfix-dovecot-mysql-and-spamassassin">DigitalOcean</a> or <a href="https://www.linode.com/docs/email/postfix/email-with-postfix-dovecot-and-mysql">Linode</a>.
Any other MySQL configuration requires edits to PostMaster's database models. Paid support for this is available.</li>
<li>A working Docker host</li>
</ol>
<h3 id="mysql-preparation">MySQL Preparation</h3>
<ol>
<li>
<p>Start by logging into the MySQL server that your mail server uses:</p>
<pre><code>mysql -u root -p
</code></pre>
</li>
<li>
<p>Once you've logged into MySQL, create a PostMaster MySQL user that has privileges to edit the tables for the servermail database.
Make sure to replace 'docker.postmaster.local' with your Docker host's IP address or DNS:</p>
<pre><code>GRANT ALL PRIVILEGES ON servermail.* TO 'postmasteruser'@'docker.postmaster.local' IDENTIFIED BY 'password_changeme';
</code></pre>
</li>
<li>
<p>Exit from MySQL:</p>
<pre><code>exit
</code></pre>
</li>
<li>
<p>If you are installing PostMaster on a server other than where your mail server's MySQL server is installed, make sure that
bind-address is set 0.0.0.0 and not 127.0.0.1 in:</p>
<pre><code>/etc/mysql/my.cnf
</code></pre>
</li>
</ol>
<h3 id="installation">Installation</h3>
<ol>
<li>
<p>Switch to the Docker host, and login as root:</p>
<pre><code>sudo su -
</code></pre>
</li>
<li>
<p>As root, create the following folder on the Docker host to hold PostMaster's data volume:</p>
<pre><code>mkdir /opt/postmaster_data
</code></pre>
</li>
<li>
<p>Provide the appropriate permissions to PostMaster's data volume:</p>
<pre><code>chown root:root /opt/postmaster_data &amp;&amp; chmod 770 /opt/postmaster_data
</code></pre>
</li>
<li>
<p>Download the PostMaster sourcecode from GitHub:</p>
<pre><code>git clone https://github.com/StackFocus/PostMaster.git ~/postmaster
</code></pre>
</li>
<li>
<p>Build the Docker image:</p>
<pre><code>cd ~/postmaster
docker build -t postmaster .
</code></pre>
</li>
<li>
<p>Run a PostMaster Docker container from the created image.
The -v points to the data volume that was created in step 2.
The -p has the Docker host serve port 80 of the PostMaster container. Change this to what suits your environment.
The -e specifies the value of the DB_URI environment variable, which is the URI that PostMaster will use to connect to your mail server's MySQL server.
Make sure to replace 'password_changeme' and 'docker.postmaster.local' with what you configured in step 2 of MySQL Preparation:</p>
<pre><code>docker run -p 0.0.0.0:80:80 -v /opt/postmaster_data:/opt/postmaster/git/db \
     -e DB_URI=mysql://postmasteruser:password_changeme@docker.postmaster.local:3306/servermail -d postmaster
</code></pre>
</li>
<li>
<p>PostMaster should now be running. Simply use the username "admin" and the password "PostMaster" to login.
You can change your username and password from Manage -&gt; Administrators.</p>
</li>
</ol>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Ubuntu%2014.04/" class="btn btn-neutral float-right" title="Ubuntu 14.04">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../Configuration/Configurations%20Page/" class="btn btn-neutral" title="Configurations Page"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Documentation generated on 2016-03-18 01:12:53.822000<p>
  </div>
  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/stackfocus/postmaster" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../Configuration/Configurations%20Page/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Ubuntu%2014.04/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
